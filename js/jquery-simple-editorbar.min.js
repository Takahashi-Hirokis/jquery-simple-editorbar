$.fn.toolbar=function(options){const docCommand={fontSize:{display:(options=$.extend({fontSize:this.attr("fontSize")||!1,fontColor:this.attr("fontColor")||!1,backgroundColor:this.attr("backgroundColor")||!1,fontWeight:this.attr("fontWeight")||!1,strikeThrough:this.attr("strikeThrough")||!1,alignLeft:this.attr("alignLeft")||!1,alignCenter:this.attr("alignCenter")||!1,hyperLink:this.attr("hyperLink")||!1,update:this.attr("update")||null},options||{})).fontSize&&!0,type:"select",field:options.fontSize.field||"font-size-select",def:options.fontSize.def||"13,16,18,20,24",input:null,html:"span",node:"surround",attr:options.fontSize.attr||null,style:options.fontSize.style||function(){return`font-size: ${this.input}`}},fontColor:{display:options.fontColor&&!0,type:"value",field:options.fontColor.field||"font-color-input",def:options.fontColor.def||"#4A4A4A",input:null,html:"span",node:"surround",attr:options.fontColor.attr||null,style:options.fontColor.style||function(){return`color: ${this.input}`}},backgroundColor:{display:options.backgroundColor&&!0,type:"value",field:options.backgroundColor.field||"bg-color-input",def:options.backgroundColor.def||"#FFFFFF",input:null,html:"span",node:"surround",attr:options.backgroundColor.attr||null,style:options.backgroundColor.style||function(){return`background-color: ${this.input}; padding: 0.1rem 0.8rem`}},fontWeight:{display:options.fontWeight&&!0,type:!1,field:null,def:null,input:null,html:"span",node:"surround",attr:options.fontWeight.attr||null,style:options.fontWeight.style||"font-weight: bold"},strikeThrough:{display:options.strikeThrough&&!0,type:!1,field:null,def:null,input:null,html:"span",node:"surround",attr:options.strikeThrough.attr||null,style:options.strikeThrough.style||"text-decoration: line-through"},alignLeft:{display:options.alignLeft&&!0,type:!1,field:null,def:null,input:null,html:"div",node:"surround",attr:options.alignLeft.attr||null,style:options.alignLeft.style||"text-align: left"},alignCenter:{display:options.alignCenter&&!0,type:!1,field:null,def:null,input:null,html:"div",node:"surround",attr:options.alignCenter.attr||null,style:options.alignCenter.style||"text-align: center"},hyperLink:{display:options.hyperLink&&!0,type:"drop",field:options.hyperLink.field||"link-input",def:options.hyperLink.def||null,input:null,html:"a",node:"surround",attr:options.hyperLink.attr||function(){return{href:this.input}},style:options.hyperLink.style||null}},toolbarContainer=$("<div class='tool-bar' />"),buttonFlame="<div class='tool-bar-btn' />",dropDownFlame="<input type='checkbox' id='dd-link' class='drop-down'><label for='dd-link' class='dd-label'></label>",buttonTemplates={fontSize:$("<button type='button' class='font-size' data-alias='fontSize'><i></i></button>"),fontColor:$("<button type='button' class='font-color' data-alias='fontColor'><i></i></button>"),backgroundColor:$("<button type='button' class='background-color' data-alias='backgroundColor'><i></i></button>"),fontWeight:$("<button type='button' class='font-weight' data-alias='fontWeight'><i></i></button>"),strikeThrough:$("<button type='button' class='strike-through' data-alias='strikeThrough'><i></i></button>"),alignLeft:$("<button type='button' class='align-left' data-alias='alignLeft'><i></i></button>"),alignCenter:$("<button type='button' class='align-center' data-alias='alignCenter'><i></i></button>"),hyperLink:$("<button type='button' class='hyper-link' data-alias='hyperLink'><i></i></button>")},inputTemplates={fontSize:$(`<select class='${docCommand.fontSize.field}'>`),fontColor:$(`<input type='color' class='${docCommand.fontColor.field}'>`),backgroundColor:$(`<input type='color' class='${docCommand.backgroundColor.field}'>`),fontWeight:null,strikeThrough:null,alignLeft:null,alignCenter:null,hyperLink:$(`${dropDownFlame}<div class='dd-bar'>URL<input type='url' class='${docCommand.hyperLink.field}'></div>`)},_surroundNode=function(nodeObj){const select=window.getSelection();if(!select||0===String(select).length)return;const range=select.getRangeAt(0),html=$(range.startContainer.parentElement);if(html[0].contentEditable){const node=document.createElement(nodeObj.html),attr="function"==typeof nodeObj.attr?nodeObj.attr():nodeObj.attr;if(attr&&Object.keys(attr).length)for(let key in attr)node.setAttribute(key,attr[key]);const style="function"==typeof nodeObj.style?nodeObj.style():nodeObj.style;style&&style.length&&node.setAttribute("style",style),node.appendChild(range.extractContents()),range.insertNode(node)}},_insertNode=function(nodeObj){const select=window.getSelection(),range=select.getRangeAt(0),html=$(range.startContainer.parentElement);if(html[0].contentEditable){const node=document.createElement(nodeObj.html),attr="function"==typeof nodeObj.attr?nodeObj.attr():nodeObj.attr;if(attr&&Object.keys(attr).length)for(let key in attr)node.setAttribute(key,attr[key]);const style="function"==typeof nodeObj.style?nodeObj.style():nodeObj.style;style&&style.length&&node.setAttribute("style",style),range.deleteContents(),range.insertNode(node),select.collapseToEnd()}},_trigger=function(callback){null!==callback&&callback()};for(let key in docCommand){if(!docCommand[key].display)continue;const $template=$(buttonFlame);if($template.append($(buttonTemplates[key])),docCommand[key].type){const def=docCommand[key].def;if("value"===docCommand[key].type)$(inputTemplates[key]).val(def);else if("select"===docCommand[key].type){def.replaceAll(" ","");const optionValue=def.split(",");for(let value of optionValue)$(inputTemplates[key]).append($(`<option value='${value}'>${value}</option>`))}$template.append($(inputTemplates[key]))}toolbarContainer.append($template)}$(this).append(toolbarContainer),$(".tool-bar-btn > button").on("click",(function(){const data=$(this).data("alias"),input=$(`.${docCommand[data].field}`).val();docCommand[data].input=input,"surround"===docCommand[data].node&&_surroundNode(docCommand[data]),"insert"===docCommand[data].node&&_insertNode(docCommand[data]),_trigger(options.update)}))};